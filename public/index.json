[
{
	"uri": "/1-data-management/",
	"title": "Data Management",
	"tags": [],
	"description": "",
	"content": "  How to reshape data - wide or long form in the R programming language     "
},
{
	"uri": "/4-statistical-modelling/4-1-discrete-response/",
	"title": "Discrete response",
	"tags": [],
	"description": "Models for binary and count outcomes",
	"content": "  Generalized linear model (GLM) : Poisson regression for count and rate     "
},
{
	"uri": "/4-statistical-modelling/4-2-continuous-response/",
	"title": "Continuous response",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/2-data-visualisation/",
	"title": "Data Visualisation",
	"tags": [],
	"description": "",
	"content": " Data Visualisation in R  "
},
{
	"uri": "/3-basic-statistics/",
	"title": "Basic Statistics",
	"tags": [],
	"description": "",
	"content": " Basic Statistics Foundation and Theory of Statistics and some common statitical test\n "
},
{
	"uri": "/4-statistical-modelling/",
	"title": "Statistical Models",
	"tags": [],
	"description": "",
	"content": "  Discrete response    Generalized linear model (GLM) : Poisson regression for count and rate      Continuous response     "
},
{
	"uri": "/1-data-management/reshaping-data-into-wide-or-long-format-in-r/",
	"title": "How to reshape data - wide or long form in the R programming language",
	"tags": ["dataframe", "r", "reshape"],
	"description": "Reshape data frame or matrix either in wide or long format in R programming language.",
	"content": "\r\rReshaping though frequently required in data analysis, so often it remains confusing even if you are frequent user of reshape function in R.Here I have provided more explanation with simulated data.\n[1] Wide to long\rWide data: the observation has been made several time but all the observations for given person is recorded in single row in spreadsheet.For example, in clinic, person visiting every month for their blood pressure check, and nurse note down the value for each month in single row which belong to this specific person.\nLet’s first create small wide data\n# wide data\rdf \u0026lt;- data.frame(matrix(data = NA, nrow = 3, ncol = 5, dimnames = list(NULL, paste0(c(\u0026quot;id\u0026quot;,\u0026quot;name\u0026quot;,\u0026quot;jan\u0026quot;,\u0026quot;feb\u0026quot;,\u0026quot;march\u0026quot;)))))\rdf[1,] \u0026lt;- c(1,\u0026quot;A\u0026quot;,123,120,125)\rdf[2,] \u0026lt;- c(2,\u0026quot;B\u0026quot;,140,150,155)\rdf[3,] \u0026lt;- c(3,\u0026quot;C\u0026quot;,96,86,97)\rOur “wide” data look like\n\r\rid\r\rname\r\rjan\r\rfeb\r\rmarch\r\r\r\r\r\r1\r\rA\r\r123\r\r120\r\r125\r\r\r\r2\r\rB\r\r140\r\r150\r\r155\r\r\r\r3\r\rC\r\r96\r\r86\r\r97\r\r\r\r\rNow rather than recording each month’s observation in row, we want data each which only one observation per row for that given person. for that we need to use standard reshape command in R.\nThe reshape has following argument:\n\ridvar : unique identifier for person,place or object on which observations(measurements) are made at different time points or repeatedly. Example Case ID\n\rvarying : if observation for specific individuals are made at different time points, in which columns values are recorded i.e time-varying columns. Example Jan, Feb, March\n\rtimevar: what will be the name of column once the time-varying columns above has been staked in rows. Example Month\n\rtimes : what will be the values (of time) once the time-varying columns above has been staked in rows. Example Jan, Feb, March\n\rv.names: what will be the values (of observations) once the time-varying columns above has been staked in rows. Example BP\n\rdirection: data needs to converted from wide to long format.\n\r\rdf_long \u0026lt;- reshape(df,\ridvar = \u0026quot;id\u0026quot;, #[unique identifier for person,place or object on which observations(measurments) are made at different time points or repeatedly]\rvarying = c(\u0026quot;jan\u0026quot;,\u0026quot;feb\u0026quot;,\u0026quot;march\u0026quot;), # [if observation for specific individulas are made at different time points, in which columns values are recorded i.e time-varying columns ]\rtimevar = \u0026quot;month\u0026quot;, # [what will be the name of column once the timevarying columns above has been staked in rows]\rtimes = c(\u0026quot;jan\u0026quot;,\u0026quot;feb\u0026quot;,\u0026quot;march\u0026quot;),\r# [what will be the values (of time) once the timevarying columns above has been staked in rows]\rv.names = \u0026quot;BP\u0026quot;, # [what will be the values (of observations) once the timevarying columns above has been staked in rows]\rdirection = \u0026quot;long\u0026quot;) # [we want to convert wide df into long one])\rOur “long” data look like\ndf_long \u0026lt;- arrange(df_long, id)\rkable(df_long,format = \u0026quot;html\u0026quot;) %\u0026gt;% kable_styling(full_width = F, position = \u0026quot;center\u0026quot;,font_size = 14)\r\r\rid\r\rname\r\rmonth\r\rBP\r\r\r\r\r\r1\r\rA\r\rjan\r\r123\r\r\r\r1\r\rA\r\rfeb\r\r120\r\r\r\r1\r\rA\r\rmarch\r\r125\r\r\r\r2\r\rB\r\rjan\r\r140\r\r\r\r2\r\rB\r\rfeb\r\r150\r\r\r\r2\r\rB\r\rmarch\r\r155\r\r\r\r3\r\rC\r\rjan\r\r96\r\r\r\r3\r\rC\r\rfeb\r\r86\r\r\r\r3\r\rC\r\rmarch\r\r97\r\r\r\r\rSometime, not only one type of measurement (BP) but also other types (such as Heart rate -HR) are measured and recorded row wise. For example,\nThis data can be converted into “long” by using list for group of time-varying columns for varying\ndf_long \u0026lt;- reshape(df,\ridvar = \u0026quot;id\u0026quot;, varying = list(c(\u0026quot;BP_jan\u0026quot;,\u0026quot;BP_feb\u0026quot;,\u0026quot;BP_march\u0026quot;),c(\u0026quot;HR_jan\u0026quot;,\u0026quot;HR_feb\u0026quot;,\u0026quot;HR_march\u0026quot;) ), timevar = \u0026quot;month\u0026quot;, times = c(\u0026quot;jan\u0026quot;,\u0026quot;feb\u0026quot;,\u0026quot;march\u0026quot;),\rv.names = c(\u0026quot;BP\u0026quot;,\u0026quot;HR\u0026quot;), direction = \u0026quot;long\u0026quot;) \r\r\rid\r\rname\r\rmonth\r\rBP\r\rHR\r\r\r\r\r\r1\r\rA\r\rjan\r\r123\r\r72\r\r\r\r1\r\rA\r\rfeb\r\r120\r\r70\r\r\r\r1\r\rA\r\rmarch\r\r125\r\r71\r\r\r\r2\r\rB\r\rjan\r\r140\r\r85\r\r\r\r2\r\rB\r\rfeb\r\r150\r\r82\r\r\r\r2\r\rB\r\rmarch\r\r155\r\r86\r\r\r\r3\r\rC\r\rjan\r\r96\r\r65\r\r\r\r3\r\rC\r\rfeb\r\r86\r\r52\r\r\r\r3\r\rC\r\rmarch\r\r97\r\r59\r\r\r\r\r\r[2] long to wide\rTo make data “wide” from long, the reshape function will need only two main arguments apart from id.\n\rv.names : which column represent values of the observations in long data ( so that reshape function can transform these values into rows for each ID)\n\rtimevar : which column represent the timing of the observations ( so that reshape function associate it with the value for given time for each ID )\n\r\rHere is the example\ndf_wide \u0026lt;- reshape(df_long,\ridvar = \u0026quot;id\u0026quot;,\r# unique identifier\rv.names = c(\u0026quot;BP\u0026quot;,\u0026quot;HR\u0026quot;),\r# the columns represent the value of the observation (BP,HR)\rtimevar = \u0026quot;month\u0026quot;,\r# the column represent the timing of the observations\rdirection = \u0026quot;wide\u0026quot;\r)\rHere is the wide data\nkable(df_wide,format = \u0026quot;html\u0026quot;) %\u0026gt;% kable_styling(full_width = F, position = \u0026quot;center\u0026quot;,font_size = 14)\r\r\r\rid\r\rname\r\rBP.jan\r\rHR.jan\r\rBP.feb\r\rHR.feb\r\rBP.march\r\rHR.march\r\r\r\r\r\r1\r\r1\r\rA\r\r123\r\r72\r\r120\r\r70\r\r125\r\r71\r\r\r\r4\r\r2\r\rB\r\r140\r\r85\r\r150\r\r82\r\r155\r\r86\r\r\r\r7\r\r3\r\rC\r\r96\r\r65\r\r86\r\r52\r\r97\r\r59\r\r\r\r\r\r"
},
{
	"uri": "/4-statistical-modelling/4-1-discrete-response/4-1-3-count-response/count-data-models/",
	"title": "Generalized linear model (GLM) : Poisson regression for count and rate",
	"tags": ["Poisson", "Quasi-poisson", "Negative binomial", "Zero inflated", "GLM"],
	"description": "Poisson regression model part of Generalized linear models (GLM), its statistical assumptions and interpretation (risk ratio). Also about zero-inflated, negative binomial and generalized poisson models",
	"content": "\rwhat is count or count variable\rCount is a number which is discrete and non-negative. Discrete means a number which is a countable and distinct. For example, number of road accidents. Road accidents can be 2 or 852 but can not be 2.1 or 85.5. So its discrete i.e integer. This is different to numeric continuous variable (such as blood pressure 120.2,135.9) which modelled differently.\nCount may also have contextual information i.e with time, area or length. Such as number of road accidents in given year, number of rain drops in square meter area. When the count is associated with any denominators, rate can be derived. For example, we observe 25 number of maternity claims from 850 women in year then the rate of claims will be 29 per 1000 women per year.\n\rProbability distribution(s) associated with the count random variable\rFirst we need to clarify what is a distribution.The Distribution is the specification of probability associated with the value taken by random variable on random experiment. For example, in random experiment of counting number of rain drops in square meter area. The random variable is number of rain drops. Once the experiment has been performed, we count the drop which may be 10. The random variable X taken the value of 10.We do this experiment again and its 35. So random variable X has taken the value of 35.\nNow if we know the average rate of some event \\([\\lambda]\\) in which event happening indepdently in time. Then the number of event in any time period has poisson distribution.\nFor example, in neighborhood road, on avaerge 2 cars passing by every hour. We noted the number of cars passing by continuously for 10 hours. We may get following numbers\nWe can derive the probability associated with each event and plot it with number of cars ( X axis ) and probability associated with it on Y axis\nThe prime distribution of count is poisson. The other models are available to overcome two majors issues in counts : over-dispersion (or less often under-dispersion) and excess zeros. Or sometime zero is impossible value for the outcome ( such length of stay-no 0 length of stay), in this condition, zero truncated model is useful.\nTo overcome over or under dispersion:\n\rNegative Binomial distribution (NB)\rPoisson Inverse Gaussian (PIG)\rGeneralized Negative Binomial Model\rGeneralised Poisson\rHeterogeneous Negative Binomial model (NB-H)\r\rTo ovecome excess zero’s:\n\rzero-inflated Poisson (ZIP)\rzero-inflated negative binomial (ZINB)\rHurdle model\r\rTo model outcome where 0 is impossible value\n\rzero truncated models\r\rFigure 1 Models for count data: mean-variance relationships and its parameterisation\n\r1 Poisson distribution\r\rsingle parameter\rmean \\([\\mu]\\) is equal to variance \\([\\mu]\\), also called dispersion\rin real life datasets, more often there will be higher variability or correlation than model allows (over-dispersion) which leads to biased standard errors ( so as misleading significance of covariate)\r\r\r2 Negative Binomial\r\rhas additional dispersion parameter \\([\\alpha]\\) to accommodate excess variability. when the dispersion parameter is zero,\rthe model becomes Poisson\rcan be traditional negative binomial (NB1) or quadratic negative binomial (NB2)\rOnly correct over-dispersion ( not under-dispersion of poisson)\rform of Poisson-gamma mixture with dispersion parameter \\([\\alpha]\\) has gamma distribution. Gamma distribution is very flexible in shape so most (not all) dispersed count data modelled well with NB\rIt is possible that NB may not correct over-dispersion in a Poisson model\r\r\r3 Poisson Inverse Gaussian (PIG)\r\rSimiller to negative binomial except the dispersion parameter \\([\\alpha]\\) has inverse Gaussian distribution\rAvailable in R gamlass package\r\r\r4 Generalized Negative Binomial Model (GNB)\r\rThe GNB parametrizes the exponent on the second term of the\rnegative binomial variance.\rTo get initial idea whether data is suited to NB1 or NB2 or NB-P\r\r\r5 Generalised Poissson Models\r\rSi miller to above models but dispersion parameter can take negative values which also correct under dispersion if present\r\r\r6 Heterogeneous Negative Binomail model (NB-H)\r\rDispersion parameter can be associated with particular covariate which bring significant dispersion in the model.\r\r\r7 Exact poisson regression\rfor unbalanced and sparse count data\nIn count model log of count are modelled with respect to linear predictors. This is will make sure that predicted count will always be positive.\nThe expected percentage of zero counts on the basis of the Poisson\rmodel is under 1%. If mean of count response is 5 or below and some 30% of the count observations consist of zeros,ZIP or ZINB will be good choice.\n\r\r"
},
{
	"uri": "/_header/",
	"title": "",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/categories/data-management/",
	"title": "Data Management",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/dataframe/",
	"title": "Dataframe",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/glm/",
	"title": "Glm",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/categories/glm/",
	"title": "Glm",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/",
	"title": "Home",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/negative-binomial/",
	"title": "Negative Binomial",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/poisson/",
	"title": "Poisson",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/quasi-poisson/",
	"title": "Quasi Poisson",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/r/",
	"title": "R",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/reshape/",
	"title": "Reshape",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/zero-inflated/",
	"title": "Zero Inflated",
	"tags": [],
	"description": "",
	"content": ""
}]