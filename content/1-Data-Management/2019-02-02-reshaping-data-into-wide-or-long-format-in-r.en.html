---
title: "Reshaping data into wide or long format in R"
author: "Chetan Prajapati"
date: '2019-02-02'
description: Reshaping data into wide or long formate in R
keywords: reshape
menuTitle: Reshaping data in to R
pageimage:
  image:
    height: 600
    url: /imgages/Reshape.png
    width: 800
slug: reshaping-data-into-wide-or-long-format-in-r
tags:
- dataframe
- wide
- long
- R
categories: 
- reshape
---



<p><img alt="reshape data wide long r gather melt dplyr" src="/images/Reshape.png" height="300px" width="400px" /></p>
<p>Reshaping though frequently required in data analysis, so often it remains confusing even if you are frequent user of <code>reshape</code> function in R.Here I have provided more explanation with simulated data.</p>
<div id="wide-to-long" class="section level4">
<h4>[1] Wide to long</h4>
<p>Wide data: the observation has been made several time but all the observations for given person is recorded in single row in spreadsheet.For example, in clinic, person visiting every month for their blood pressure check, and nurse note down the value for each month in single row which belong to this specific person.</p>
<p>Let’s first create small wide data</p>
<pre class="r"><code># wide data
df &lt;- data.frame(matrix(data = NA, nrow = 3, ncol = 5, dimnames = list(NULL, paste0(c(&quot;id&quot;,&quot;name&quot;,&quot;jan&quot;,&quot;feb&quot;,&quot;march&quot;)))))
df[1,] &lt;- c(1,&quot;A&quot;,123,120,125)
df[2,] &lt;- c(2,&quot;B&quot;,140,150,155)
df[3,] &lt;- c(3,&quot;C&quot;,96,86,97)</code></pre>
<p>Our “wide” data look like</p>
<pre><code>##   id name jan feb march
## 1  1    A 123 120   125
## 2  2    B 140 150   155
## 3  3    C  96  86    97</code></pre>
<p>Now rather than recording each month’s observation in row, we want data each which only one observation per row for that given person. for that we need to use standard <code>reshape</code> command in <code>R</code>.</p>
<p>The <code>reshape</code> has following argument:</p>
<ul>
<li><p><code>idvar</code> : unique identifier for person,place or object on which observations(measurments) are made at different time points or repeatedly. Example <code>Case ID</code></p></li>
<li><p><code>varying</code> : if observation for specific individulas are made at different time points, in which columns values are recorded i.e time-varying columns. Example <code>Jan</code>, <code>Feb</code>, <code>March</code></p></li>
<li><p><code>timevar</code>: what will be the name of column once the timevarying columns above has been staked in rows. Example <code>Month</code></p></li>
<li><p><code>times</code> : what will be the values (of time) once the timevarying columns above has been staked in rows. Example <code>Jan</code>, <code>Feb</code>, <code>March</code></p></li>
<li><p><code>v.names</code>: what will be the values (of observations) once the timevarying columns above has been staked in rows. Example <code>BP</code></p></li>
<li><p><code>direction</code>: data needs to converted from wide to <code>long</code> format.</p></li>
</ul>
<pre class="r"><code>df_long &lt;- reshape(df,
idvar = &quot;id&quot;,  
        #[unique identifier for person,place or object on which observations(measurments) are made at different time points or repeatedly]

varying = c(&quot;jan&quot;,&quot;feb&quot;,&quot;march&quot;),  
        # [if observation for specific individulas are made at different time points, in which columns values are recorded i.e time-varying columns ]

timevar = &quot;month&quot;, 
        # [what will be the name of column once the timevarying columns above has been staked in rows]

times = c(&quot;jan&quot;,&quot;feb&quot;,&quot;march&quot;),
        # [what will be the values (of time) once the timevarying columns above has been staked in rows]

v.names = &quot;BP&quot;, 
        # [what will be the values (of observations) once the timevarying columns above has been staked in rows]

direction = &quot;long&quot;)   
        # [we want to convert wide df into long one])</code></pre>
<p>Our “long” data look like</p>
<pre class="r"><code>require(dplyr)
df_long &lt;- arrange(df_long, id)
df_long</code></pre>
<pre><code>##   id name month  BP
## 1  1    A   jan 123
## 2  1    A   feb 120
## 3  1    A march 125
## 4  2    B   jan 140
## 5  2    B   feb 150
## 6  2    B march 155
## 7  3    C   jan  96
## 8  3    C   feb  86
## 9  3    C march  97</code></pre>
<p>Sometime, not only one type of measurement (BP) but also other types (such as Heart rate -HR) are measured and recorded row wise. For example,</p>
<pre><code>##   id name BP_jan BP_feb BP_march HR_jan HR_feb HR_march
## 1  1    A    123    120      125     72     70       71
## 2  2    B    140    150      155     85     82       86
## 3  3    C     96     86       97     65     52       59</code></pre>
<p>This data can be converted into “long” by using <code>list</code> for group of time-varying columns for <code>varying</code></p>
<pre class="r"><code>df_long &lt;- reshape(df,
idvar = &quot;id&quot;,  
varying = list(c(&quot;BP_jan&quot;,&quot;BP_feb&quot;,&quot;BP_march&quot;),c(&quot;HR_jan&quot;,&quot;HR_feb&quot;,&quot;HR_march&quot;) ),  
timevar = &quot;month&quot;, 
times = c(&quot;jan&quot;,&quot;feb&quot;,&quot;march&quot;),
v.names = c(&quot;BP&quot;,&quot;HR&quot;), 
direction = &quot;long&quot;)   </code></pre>
<pre><code>##   id name month  BP HR
## 1  1    A   jan 123 72
## 2  1    A   feb 120 70
## 3  1    A march 125 71
## 4  2    B   jan 140 85
## 5  2    B   feb 150 82
## 6  2    B march 155 86
## 7  3    C   jan  96 65
## 8  3    C   feb  86 52
## 9  3    C march  97 59</code></pre>
</div>
<div id="long-to-wide" class="section level4">
<h4>[2] long to wide</h4>
<p>To make data “wide” from long, the <code>reshape</code> function will need only two main argumennts apart from id.</p>
<ul>
<li><p><code>v.names</code> : which column represent <strong>values</strong> of the observations in long data ( so that <code>reshape</code> function can transform these values into rows for each ID)</p></li>
<li><p><code>timevar</code> : which column represent <strong>the timing</strong> of the observations ( so that <code>reshape</code> function associate it with the value for given time for each ID )</p></li>
</ul>
<p>Here is the example</p>
<pre class="r"><code>df_wide &lt;- reshape(df_long,
       idvar = &quot;id&quot;,
       # unique identifier
       v.names = c(&quot;BP&quot;,&quot;HR&quot;),
       # the columns represent the value of the observation (BP,HR)
       timevar = &quot;month&quot;,
       # the column represent the timing of the observations
       direction = &quot;wide&quot;
        )</code></pre>
<p>Here is the wide data</p>
<pre class="r"><code>df_wide</code></pre>
<pre><code>##   id name BP.jan HR.jan BP.feb HR.feb BP.march HR.march
## 1  1    A    123     72    120     70      125       71
## 4  2    B    140     85    150     82      155       86
## 7  3    C     96     65     86     52       97       59</code></pre>
</div>
