---
title: "How to reshape data in wide or long format in R"
author: "Chetan Prajapati"
date: "2019-02-02"
description: Complete tutorial about reshaping data into wide or long format using standard r reshape function.
keywords: 
- matrix
- data
- r
- programming
- wide
- long
menuTitle: Reshaping
pageimage:
  image:
    height: 600
    url: /images/Reshape.png
    width: 800
    text: reshape wide long r
slug: reshape-wide-long-data-r-how-to
tags:
- dataframe
- r
- reshape
categories: 
- data management
sitemap:
  ChangeFreq: daily
  Priority: 0.9

---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>


<p><img alt="reshape data wide long r gather melt dplyr" src="/images/Reshape.png" height="300px" width="400px" /></p>
<p>Reshaping though frequently required in data analysis, so often it remains confusing even if you are frequent user of <code>reshape</code> function in R.Here I have provided more explanation with simulated data.</p>
<div id="reshape-data-from-wide-to-long" class="section level2">
<h2>Reshape data from wide to long</h2>
<p>Wide data: the observation has been made several time but all the observations for given person is recorded in single row in spreadsheet.For example, in clinic, person visiting every month for their blood pressure check, and nurse note down the value for each month in single row which belong to this specific person.</p>
<p>Let’s first create small wide data</p>
<pre class="r"><code># wide data
df &lt;- data.frame(matrix(data = NA, nrow = 3, ncol = 5, dimnames = list(NULL, paste0(c(&quot;id&quot;,&quot;name&quot;,&quot;jan&quot;,&quot;feb&quot;,&quot;march&quot;)))))
df[1,] &lt;- c(1,&quot;A&quot;,123,120,125)
df[2,] &lt;- c(2,&quot;B&quot;,140,150,155)
df[3,] &lt;- c(3,&quot;C&quot;,96,86,97)</code></pre>
<p>Our “wide” data look like</p>
<table class="table" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
jan
</th>
<th style="text-align:left;">
feb
</th>
<th style="text-align:left;">
march
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
123
</td>
<td style="text-align:left;">
120
</td>
<td style="text-align:left;">
125
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
140
</td>
<td style="text-align:left;">
150
</td>
<td style="text-align:left;">
155
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
86
</td>
<td style="text-align:left;">
97
</td>
</tr>
</tbody>
</table>
<p>Now rather than recording each month’s observation in row, we want data each which only one observation per row for that given person. for that we need to use standard <code>reshape</code> command in <code>R</code>.</p>
<p>The <code>reshape</code> has following argument:</p>
<ul>
<li><p><code>idvar</code> : unique identifier for person,place or object on which observations(measurements) are made at different time points or repeatedly. Example <code>Case ID</code></p></li>
<li><p><code>varying</code> : if observation for specific individuals are made at different time points, in which columns values are recorded i.e time-varying columns. Example <code>Jan</code>, <code>Feb</code>, <code>March</code></p></li>
<li><p><code>timevar</code>: what will be the name of column once the time-varying columns above has been staked in rows. Example <code>Month</code></p></li>
<li><p><code>times</code> : what will be the values (of time) once the time-varying columns above has been staked in rows. Example <code>Jan</code>, <code>Feb</code>, <code>March</code></p></li>
<li><p><code>v.names</code>: what will be the values (of observations) once the time-varying columns above has been staked in rows. Example <code>BP</code></p></li>
<li><p><code>direction</code>: data needs to converted from wide to <code>long</code> format.</p></li>
</ul>
<pre class="r"><code>df_long &lt;- reshape(df,
idvar = &quot;id&quot;,  
        #[unique identifier for person,place or object on which observations(measurments) are made at different time points or repeatedly]

varying = c(&quot;jan&quot;,&quot;feb&quot;,&quot;march&quot;),  
        # [if observation for specific individulas are made at different time points, in which columns values are recorded i.e time-varying columns ]

timevar = &quot;month&quot;, 
        # [what will be the name of column once the timevarying columns above has been staked in rows]

times = c(&quot;jan&quot;,&quot;feb&quot;,&quot;march&quot;),
        # [what will be the values (of time) once the timevarying columns above has been staked in rows]

v.names = &quot;BP&quot;, 
        # [what will be the values (of observations) once the timevarying columns above has been staked in rows]

direction = &quot;long&quot;)   
        # [we want to convert wide df into long one])</code></pre>
<p>Our “long” data look like</p>
<pre class="r"><code>df_long &lt;- arrange(df_long, id)

kable(df_long,format = &quot;html&quot;) %&gt;%  kable_styling(full_width = F, position = &quot;center&quot;,font_size = 14)</code></pre>
<table class="table" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
month
</th>
<th style="text-align:left;">
BP
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
jan
</td>
<td style="text-align:left;">
123
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
feb
</td>
<td style="text-align:left;">
120
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
march
</td>
<td style="text-align:left;">
125
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
jan
</td>
<td style="text-align:left;">
140
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
feb
</td>
<td style="text-align:left;">
150
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
march
</td>
<td style="text-align:left;">
155
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
jan
</td>
<td style="text-align:left;">
96
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
feb
</td>
<td style="text-align:left;">
86
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
march
</td>
<td style="text-align:left;">
97
</td>
</tr>
</tbody>
</table>
<p>Sometime, not only one type of measurement (BP) but also other types (such as Heart rate -HR) are measured and recorded row wise. For example,</p>
<p>This data can be converted into “long” by using <code>list</code> for group of time-varying columns for <code>varying</code></p>
<pre class="r"><code>df_long &lt;- reshape(df,
idvar = &quot;id&quot;,  
varying = list(c(&quot;BP_jan&quot;,&quot;BP_feb&quot;,&quot;BP_march&quot;),c(&quot;HR_jan&quot;,&quot;HR_feb&quot;,&quot;HR_march&quot;) ),  
timevar = &quot;month&quot;, 
times = c(&quot;jan&quot;,&quot;feb&quot;,&quot;march&quot;),
v.names = c(&quot;BP&quot;,&quot;HR&quot;), 
direction = &quot;long&quot;)   </code></pre>
<pre class="r"><code>df_long &lt;- arrange(df_long, id)</code></pre>
<table class="table" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
month
</th>
<th style="text-align:left;">
BP
</th>
<th style="text-align:left;">
HR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
jan
</td>
<td style="text-align:left;">
123
</td>
<td style="text-align:left;">
72
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
feb
</td>
<td style="text-align:left;">
120
</td>
<td style="text-align:left;">
70
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
march
</td>
<td style="text-align:left;">
125
</td>
<td style="text-align:left;">
71
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
jan
</td>
<td style="text-align:left;">
140
</td>
<td style="text-align:left;">
85
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
feb
</td>
<td style="text-align:left;">
150
</td>
<td style="text-align:left;">
82
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
march
</td>
<td style="text-align:left;">
155
</td>
<td style="text-align:left;">
86
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
jan
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
65
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
feb
</td>
<td style="text-align:left;">
86
</td>
<td style="text-align:left;">
52
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
march
</td>
<td style="text-align:left;">
97
</td>
<td style="text-align:left;">
59
</td>
</tr>
</tbody>
</table>
</div>
<div id="reshape-data-from-long-to-wide" class="section level2">
<h2>Reshape data from long to wide</h2>
<p>To make data “wide” from long, the <code>reshape</code> function will need only two main arguments apart from id.</p>
<ul>
<li><p><code>v.names</code> : which column represent <strong>values</strong> of the observations in long data ( so that <code>reshape</code> function can transform these values into rows for each ID)</p></li>
<li><p><code>timevar</code> : which column represent <strong>the timing</strong> of the observations ( so that <code>reshape</code> function associate it with the value for given time for each ID )</p></li>
</ul>
<p>Here is the example</p>
<pre class="r"><code>df_wide &lt;- reshape(df_long,
       idvar = &quot;id&quot;,
       # unique identifier
       v.names = c(&quot;BP&quot;,&quot;HR&quot;),
       # the columns represent the value of the observation (BP,HR)
       timevar = &quot;month&quot;,
       # the column represent the timing of the observations
       direction = &quot;wide&quot;,
       sep = &quot;_&quot;
        )</code></pre>
<p>Here is the wide data</p>
<table class="table" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
BP_jan
</th>
<th style="text-align:left;">
HR_jan
</th>
<th style="text-align:left;">
BP_feb
</th>
<th style="text-align:left;">
HR_feb
</th>
<th style="text-align:left;">
BP_march
</th>
<th style="text-align:left;">
HR_march
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
123
</td>
<td style="text-align:left;">
72
</td>
<td style="text-align:left;">
120
</td>
<td style="text-align:left;">
70
</td>
<td style="text-align:left;">
125
</td>
<td style="text-align:left;">
71
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
140
</td>
<td style="text-align:left;">
85
</td>
<td style="text-align:left;">
150
</td>
<td style="text-align:left;">
82
</td>
<td style="text-align:left;">
155
</td>
<td style="text-align:left;">
86
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
65
</td>
<td style="text-align:left;">
86
</td>
<td style="text-align:left;">
52
</td>
<td style="text-align:left;">
97
</td>
<td style="text-align:left;">
59
</td>
</tr>
</tbody>
</table>
</div>
